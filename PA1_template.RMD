---
title: "Reproducible Research - Week 2 Project"
author: "Shak"
date: "February 16, 2017"
output: html_document
---

###1.Code for reading in the dataset and/or processing the data

```{r,echo=TRUE, message=F, warning=F}
library(readr)
activity <- read_csv("C:/Users/Shak/Downloads/activity.csv", col_types = cols(steps = col_number()))
```

###2.Histogram of the total number of steps taken each day
```{r,echo=TRUE, message=F, warning=F}
library(dplyr)
temp<-summarise(group_by(activity,date),sum(steps))
colnames(temp)<-c("date","steps_sum")
hist(temp$steps_sum,main="Histogram - Total number of steps taken each day",xlab="Steps/day")
```

###3.Mean and median number of steps taken each day

The mean is
```{r,echo=TRUE, message=F, warning=F}
mean(activity$steps,na.rm=TRUE)
```

The median is
```{r,echo=TRUE, message=F, warning=F}
median(activity$steps,na.rm=TRUE)
```

###4.Time series plot of the average number of steps taken
```{r,echo=TRUE, message=F, warning=F}
temp<-summarise(group_by(activity,interval),mean(steps,na.rm=TRUE))
colnames(temp)<-c("interval","steps_mean")
plot(temp$interval,temp$steps_mean,type="l",main="Avergae Daily Activity Pattern",xlab = "5-min interval",ylab="Avergae number of steps taken")

```

###5.The 5-minute interval that, on average, contains the maximum number of steps
```{r,echo=TRUE, message=F, warning=F}
temp<-summarise(group_by(activity,interval),mean(steps,na.rm=TRUE))
colnames(temp)<-c("interval","steps")
as.numeric(temp[which.max(temp$steps),1])
```

###6. Code to describe and show a strategy for imputing missing data
We impute the random hot deck imputation with the interval and weekday as predictors to impute the missing values
```{r,echo=TRUE, message=F, warning=F}
library(simputation)
library(VIM)
temp<-activity
temp$weekday<-weekdays(activity$date)
temp1<-impute_rhd(temp,steps~interval+weekday,backend="VIM",pool="univariate")
activity_imputed<-temp1[1:3]
```

The total number of missing values in the dataset is
```{r,echo=TRUE, message=F, warning=F}
nrow(activity)-nrow(na.omit(activity))
```

The mean after imputation is
```{r,echo=TRUE, message=F, warning=F}
mean(activity_imputed$steps,na.rm=TRUE)
```

The median after imputation is
```{r,echo=TRUE, message=F, warning=F}
median(activity_imputed$steps,na.rm=TRUE)
```

Imputing changes the mean and hence the distribution of the data. While the median has not changed in this case it generally is affected as well.


###7. Histogram of the total number of steps taken each day after missing values are imputed
```{r,echo=TRUE, message=F, warning=F}
temp<-summarise(group_by(activity_imputed,date),sum(steps))
colnames(temp)<-c("date","steps_sum")
hist(temp$steps_sum,main="Histogram - Total number of steps taken each day",xlab="Steps/day")
```

###8. Panel plot comparing the average number of steps taken per 5-minute interval across weekdays and weekends
```{r,echo=TRUE, message=F, warning=F}
temp<-activity
temp$week <- ifelse(weekdays(temp$date) %in% c("Saturday", "Sunday"), "weekend", "weekday")
temp<-summarise(group_by(temp,week,interval),mean(steps,na.rm=TRUE))
colnames(temp)<-c("week","interval","steps_mean")
temp$week<-as.factor(temp$week)
library(ggplot2)
p<-ggplot(temp,aes(x=interval,y = steps_mean))+geom_line()+facet_wrap(~week,ncol=1)
p<-p+xlab("Interval")+ylab("Number of steps")
p<-p+ theme(panel.background = element_rect(colour = "black",fill="lightgrey"))
p
```
